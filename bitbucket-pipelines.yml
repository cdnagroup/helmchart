pipelines:
  default:
    - step:
        name: Sync GitHub Mirror
        image: alpine/git:latest
        clone:
          enabled: false
        script:
          - git clone --bare git@bitbucket.org:cdnagroup/cdnachart.git
          - cd cdnachart.git
          - echo -e " \ncharts" > info/exclude
          - echo -e " \nbitbucket-pipelines.yml" > info/exclude
          - echo -e " \ngithub.gitignore" > info/exclude
          - git remote add upstream git@github.com:cdnagroup/helmchart.git
          - git push upstream master
          - git push --tags upstream
          - git remote set-url origin git@github.com:cdnagroup/helmchart.git
          - git push --mirror